### ChatBot (cont.)


#### Prologue 
> "“These stone walls, I know it only too well, are steeped in human suffering. I’ve never been able to look at them without a shudder. And yet-believe me, I am speaking from the depths of my heart —I know that even the wretchedest amongst you have sometimes seen, taking form against that grayness, a divine face. It’s that face you are asked to see.”" <br />--- The Stranger by Albert Camus"


#### I. Search capability
RDBMS has three levels of search capability: 
1. The [LIKE](https://www.w3schools.com/sql/sql_like.asp) operator is used in a `WHERE` clause to search for a specified pattern in a column.
2. Full-text search is a technique that finds specific information within a large corpus of text. It goes beyond keyword matching, and analyzes the content of documents to identify relevant results based on the user's search query
3. Semantic search is a search engine technology that interprets the meaning of words and phrases. The results of a semantic search will return content matching the meaning of a query, as opposed to content that literally matches words in the query.


#### II. Full-text search
To perform more complex full-text searches using `AND`, `OR`, and other operators in Oracle 19c, you can use the `CONTAINS` function with Oracle Text. Here are some examples of how to construct these queries:
```
CREATE TABLE items (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY,
    document VARCHAR2(1024)
);

CREATE INDEX items_fts ON items(document) INDEXTYPE IS CTXSYS.CONTEXT;
```

**Basic**
To search for documents containing "maria":
```
SELECT * FROM items
WHERE CONTAINS(document, 'maria') > 0;
```

To search for documents containing both "chan" AND "maria":
```sql
SELECT * FROM items
WHERE CONTAINS(document, 'chan AND maria') > 0;
```

To search for documents containing either "chan" OR "wong":
```
SELECT * FROM items
WHERE CONTAINS(document, 'chan OR wong') > 0;
```

**Combination**
To search for documents containing "example" and either "test" or "sample":
```sql
SELECT * FROM items
WHERE CONTAINS(document, 'maria AND (chan OR wong)') > 0;
```

To search for documents containing "chan" but not "maria":
```sql
SELECT * FROM items
WHERE CONTAINS(document, 'chan NOT maria') > 0;
```


#### III. Semantic search
```
CREATE OR REPLACE TYPE float_array_384 AS VARRAY(384) OF BINARY_FLOAT;

CREATE TABLE vec_items (
    id NUMBER GENERATED BY DEFAULT AS IDENTITY (START WITH 1) PRIMARY KEY,
    document VARCHAR2(1024),
    embedding float_array_384
);

CREATE INDEX vec_items_fts ON vec_items(document) INDEXTYPE IS CTXSYS.CONTEXT;

INSERT INTO vec_items (document, embedding) VALUES ('testing', float_array(1.1, 1.2, 1.3, 1.4));

SELECT * FROM vec_items
WHERE CONTAINS(document, 'maria') > 0;
```


#### II. Embedding the data 
```
```

#### III. Searching the data 
```
CREATE OR REPLACE FUNCTION cosine_similarity(
  array1 IN float_array_384,
  array2 IN float_array_384
) RETURN BINARY_FLOAT IS
  dot_product BINARY_FLOAT := 0;
  norm_a BINARY_FLOAT := 0;
  norm_b BINARY_FLOAT := 0;
  similarity BINARY_FLOAT;
BEGIN
  IF array1.COUNT != array2.COUNT THEN
    RAISE_APPLICATION_ERROR(-20001, 'Arrays must be of the same length');
  END IF;

  FOR i IN 1 .. array1.COUNT LOOP
    dot_product := dot_product + (array1(i) * array2(i));
    norm_a := norm_a + (array1(i) * array1(i));
    norm_b := norm_b + (array2(i) * array2(i));
  END LOOP;

  IF norm_a = 0 OR norm_b = 0 THEN
    RETURN 0;
  ELSE
    similarity := dot_product / (SQRT(norm_a) * SQRT(norm_b));
    RETURN similarity;
  END IF;
END cosine_similarity;
/
```


#### IV. Summary 


#### V. Bibliography
1. [node-llama-cpp](https://www.npmjs.com/package/node-llama-cpp)
2. [Alex Garcia's Blog](https://alexgarcia.xyz/blog/)
3. [oracledb](https://www.npmjs.com/package/oracledb)
4. [The Stranger by Albert Camus](https://www.macobo.com/essays/epdf/CAMUS,%20Albert%20-%20The%20Stranger.pdf)


#### Epilogue
> "And I, too, felt ready to start life all over again. It was as if that great rush of anger had washed me clean, emptied me of hope, and, gazing up at the dark sky spangled with its signs and stars, for the first time, the first, I laid my heart open to the benign indifference of the universe." <br />--- The Stranger by Albert Camus"


### EOF (2025/03/28)
